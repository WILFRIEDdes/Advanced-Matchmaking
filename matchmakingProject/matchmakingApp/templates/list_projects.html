{% extends 'base.html' %}

{% block title %}Liste des Projets{% endblock %}

{% block content %}

{% if messages %}
  <div class="p-4">
    {% for message in messages %}
      <div class="mb-2 p-3 rounded shadow
        {% if message.tags == 'success' %}
          bg-green-100 text-green-800
        {% elif message.tags == 'error' %}
          bg-red-100 text-red-800
        {% else %}
          bg-gray-100 text-gray-800
        {% endif %}
      ">
        {{ message }}
      </div>
    {% endfor %}
  </div>
{% endif %}

<h1 class="text-3xl font-bold mb-6 pt-11">Liste des projets</h1>

<div class="space-y-6">
    {% for projet in projets %}
        <div class="bg-white shadow-md rounded-xl p-6">
            <h2 class="text-xl font-semibold text-blue-700">{{ projet.nom }}</h2>
            <p class="text-gray-700 mt-2">{{ projet.description }}</p>
            <p class="mt-2 text-sm text-gray-600">
                üìÖ Du {{ projet.date_debut|date:"d/m/Y" }} au {{ projet.date_fin|date:"d/m/Y" }}
            </p>
            <p class="mt-2 text-sm text-gray-600">
                üè¢ Mobilit√© : {{ projet.mobilite }}
            </p>

            {% if projet.equipe %}
                <div class="mt-4">
                    <p class="font-medium text-green-600">‚úÖ √âquipe assign√©e</p>
                    <ul class="list-disc list-inside text-gray-700 mt-2">
                        {% for membre in projet.equipe.equipemembre_set.all %}
                            <li>{{ membre.utilisateur.prenom }} {{ membre.utilisateur.nom }}</li>
                        {% empty %}
                            <li>Aucun membre assign√©</li>
                        {% endfor %}
                    </ul>
                </div>
            {% else %}
                <p class="mt-4 text-red-500 font-medium">‚ùå Aucune √©quipe assign√©e</p>

                <form method="post" action="{% url 'team_generation' projet.id %}">
                    {% csrf_token %}
                    <button type="submit"
                        class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 mt-4 rounded-xl">
                        Cr√©er une √©quipe
                    </button>
                </form>
            {% endif %}
        </div>
    {% empty %}
        <p>Aucun projet trouv√©.</p>
    {% endfor %}
</div>
{% endblock %}
